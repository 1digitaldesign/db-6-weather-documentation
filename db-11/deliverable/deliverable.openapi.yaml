openapi: 3.0.3
info:
  title: Database db-11 - Parking Intelligence Database API Specification
  description: 'This database implements a comprehensive parking intelligence system
    for marketing analysis, mirroring SpotHero''s business model. The database aggregates
    parking facility data, demographics, traffic patterns, airport statistics, venue
    information, and market intelligence metrics from government sources to support
    parking marketplace operations across 400+ cities in North America.


    - Parking Facility Intelligence: Comprehensive database of parking facilities
    (lots, garages, structures) with pricing, utilization, and capacity data

    - Market Intelligence: Calculated metrics for market demand, supply analysis,
    competitive positioning, and revenue optimization

    - Geographic Coverage: 400+ cities across USA and Canada with metropolitan area
    and city-level demographics

    - Event-Based Analysis: Stadium and venue data with event scheduling and parking
    demand forecasting

    - Traffic Correlation: Traffic volume data from FHWA correlated with parking demand
    patterns

    - Airport Integration: Top 50 airports by passenger volume with parking capacity
    and utilization

    - Data Integration: ETL/ELT pipelines pulling 1+ GB of data from public APIs (Data.gov,
    Census Bureau, BTS, FAA, FHWA, City Open Data Portals)


    - PostgreSQL: Full support with PostGIS for spatial data (GEOGRAPHY type)

    - Databricks: Compatible with Delta Lake format and distributed query execution

    - Snowflake: Full support with GEOGRAPHY types and spatial functions


    This database powers a parking intelligence platform sourced from businesses with
    at least $1M ARR per year. The queries demonstrate production-grade patterns used
    by:

    - SpotHero: Parking marketplace with dynamic pricing and demand forecasting

    - ParkWhiz: Parking reservation platform with market intelligence

    - Parkopedia: Global parking database with utilization analytics

    - BestParking: Parking search and comparison platform


    ---'
  version: 1.0.0
  contact:
    name: Database Team
  license:
    name: MIT
servers:
- url: postgresql://localhost:5432/db_11
  description: PostgreSQL Server with PostGIS
- url: databricks://workspace.cloud.databricks.com
  description: Databricks Workspace
- url: https://account.snowflakecomputing.com
  description: Snowflake Account
tags:
- name: schema
  description: Database schema information
- name: tables
  description: Table definitions and structures
- name: spatial
  description: Spatial data types and operations
- name: queries
  description: SQL query definitions and metadata
- name: relationships
  description: Table relationships and foreign keys
paths:
  /schema:
    get:
      tags:
      - schema
      summary: Get database schema overview
      description: Returns overview information about the database schema
      responses:
        '200':
          description: Schema overview
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaOverview'
  /tables:
    get:
      tags:
      - tables
      summary: List all tables
      description: Returns a list of all tables in the database
      responses:
        '200':
          description: List of tables
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Table'
  /tables/{tableName}:
    get:
      tags:
      - tables
      summary: Get table details
      description: Returns detailed information about a specific table
      parameters:
      - name: tableName
        in: path
        required: true
        schema:
          type: string
        description: Name of the table
      responses:
        '200':
          description: Table details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Table'
  /queries:
    get:
      tags:
      - queries
      summary: List all SQL queries
      description: Returns metadata for all SQL queries
      responses:
        '200':
          description: List of queries
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Query'
  /queries/{queryNumber}:
    get:
      tags:
      - queries
      summary: Get query details
      description: Returns detailed information and SQL code for a specific query
      parameters:
      - name: queryNumber
        in: path
        required: true
        schema:
          type: integer
        description: Query number (1-30)
      responses:
        '200':
          description: Query details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Query'
  /spatial/operations:
    get:
      tags:
      - spatial
      summary: List spatial operations
      description: Returns available spatial operations and functions
      responses:
        '200':
          description: List of spatial operations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SpatialOperation'
components:
  schemas:
    SchemaOverview:
      type: object
      properties:
        database_name:
          type: string
          example: db-1
        database_type:
          type: string
          example: Chat/Messaging System
        created_date:
          type: string
          format: date
          example: '2026-02-03'
        total_tables:
          type: integer
          example: 11
        supported_platforms:
          type: array
          items:
            type: string
          example:
          - PostgreSQL
          - Databricks
          - Snowflake
        table_groups:
          type: array
          items:
            $ref: '#/components/schemas/TableGroup'
    TableGroup:
      type: object
      properties:
        name:
          type: string
          example: User Management
        tables:
          type: array
          items:
            type: string
          example:
          - profiles
    Table:
      type: object
      required:
      - name
      - columns
      properties:
        name:
          type: string
          example: profiles
        description:
          type: string
          example: Stores user profile information
        columns:
          type: array
          items:
            $ref: '#/components/schemas/Column'
        indexes:
          type: array
          items:
            $ref: '#/components/schemas/Index'
        constraints:
          type: array
          items:
            $ref: '#/components/schemas/Constraint'
        foreign_keys:
          type: array
          items:
            $ref: '#/components/schemas/ForeignKey'
    Column:
      type: object
      required:
      - name
      - type
      properties:
        name:
          type: string
          example: id
        type:
          type: string
          example: UUID
        nullable:
          type: boolean
          example: false
        default:
          type: string
          nullable: true
          example: gen_random_uuid()
        description:
          type: string
          example: Primary key - unique user identifier
        primary_key:
          type: boolean
          example: true
    Index:
      type: object
      properties:
        name:
          type: string
          example: idx_profiles_username
        columns:
          type: array
          items:
            type: string
          example:
          - username
        unique:
          type: boolean
          example: true
        type:
          type: string
          example: btree
    Constraint:
      type: object
      properties:
        name:
          type: string
          example: pk_profiles
        type:
          type: string
          enum:
          - PRIMARY KEY
          - UNIQUE
          - CHECK
          - NOT NULL
          example: PRIMARY KEY
        columns:
          type: array
          items:
            type: string
          example:
          - id
    ForeignKey:
      type: object
      properties:
        name:
          type: string
          example: fk_chats_created_by
        from_table:
          type: string
          example: chats
        from_column:
          type: string
          example: created_by
        to_table:
          type: string
          example: profiles
        to_column:
          type: string
          example: id
    Query:
      type: object
      required:
      - number
      - title
      - sql
      properties:
        number:
          type: integer
          example: 1
        title:
          type: string
          example: Production-Grade User Activity Analysis
        description:
          type: string
          example: Enterprise-level user activity analysis
        complexity:
          type: string
          example: Deep nested CTEs (5+ levels)
        sql:
          type: string
          example: WITH user_registration_cohorts AS (...)
        expected_output:
          type: string
          example: Top 20 users ranked by message activity
        categories:
          type: array
          items:
            type: string
          example:
          - User Activity Analysis
          - Cohort Analytics
        database_compatibility:
          type: object
          properties:
            postgresql:
              type: boolean
              example: true
            databricks:
              type: boolean
              example: true
            snowflake:
              type: boolean
              example: true
        businessUseCase:
          type: string
          example: Custom Weather Impact Modeling
        clientDeliverable:
          type: string
          example: Forecast accuracy report
        businessValue:
          type: string
          example: Quantifies forecast reliability
        spatial_operations:
          type: array
          items:
            type: string
          example:
          - ST_WITHIN
          - ST_DISTANCE
    SpatialColumn:
      type: object
      properties:
        name:
          type: string
          example: grid_cell_geom
        type:
          type: string
          enum:
          - GEOGRAPHY
          - GEOMETRY
          example: GEOGRAPHY
        geometry_type:
          type: string
          enum:
          - POINT
          - POLYGON
          - LINESTRING
          - MULTIPOINT
          - MULTIPOLYGON
          - MULTILINESTRING
          example: POINT
        crs:
          type: string
          example: EPSG:4326
        description:
          type: string
          example: Point geometry for grid cell center
    SpatialOperation:
      type: object
      properties:
        name:
          type: string
          example: ST_WITHIN
        description:
          type: string
          example: Checks if one geometry is within another
        syntax:
          type: string
          example: ST_WITHIN(geometry1, geometry2)
        return_type:
          type: string
          example: BOOLEAN
        supported_platforms:
          type: array
          items:
            type: string
          example:
          - PostgreSQL (PostGIS)
          - Databricks
          - Snowflake
  examples:
    ProfilesTable:
      summary: Example profiles table
      value:
        name: profiles
        description: Stores user profile information
        columns:
        - name: id
          type: UUID
          nullable: false
          primary_key: true
          description: Primary key - unique user identifier
        - name: username
          type: VARCHAR(255)
          nullable: false
          description: Unique username for login
        indexes:
        - name: idx_profiles_username
          columns:
          - username
          unique: true
    QueryExample:
      summary: Example query
      value:
        number: 1
        title: Production-Grade User Activity Analysis
        description: Enterprise-level user activity analysis
        sql: WITH user_registration_cohorts AS (...) SELECT ...
        expected_output: Top 20 users ranked by message activity

{
  "report_date": "2026-02-04T01:38:59.911445",
  "database": "db-1",
  "file_validated": "queries/queries.md",
  "overall_status": "FAIL",
  "summary": {
    "total_queries": 30,
    "fix_verification_status": "FAIL",
    "syntax_validation_status": "PARTIAL",
    "evaluation_status": "PASS",
    "execution_testing_status": "PARTIAL"
  },
  "phase_1_fix_verification": {
    "verification_date": "2026-02-04T01:38:58.797482",
    "file": "/Users/machine/Documents/AQ/db/db-5/queries/queries.md",
    "fixes": {
      "query_2_array_syntax": {
        "query_number": 2,
        "fix": "Array slicing syntax replacement",
        "status": "FAIL",
        "checks": [
          {
            "check": "path_preview_cte CTE exists",
            "status": "FAIL"
          },
          {
            "check": "No array slicing syntax [start:end]",
            "status": "PASS"
          },
          {
            "check": "ARRAY_LENGTH bounds checking present",
            "status": "FAIL"
          },
          {
            "check": "FROM clause uses path_preview_cte",
            "status": "PASS"
          }
        ]
      },
      "query_26_recursive_cte": {
        "query_number": 26,
        "fix": "Recursive CTE addition",
        "status": "FAIL",
        "checks": [
          {
            "check": "WITH RECURSIVE present for recursive CTE",
            "status": "FAIL"
          },
          {
            "check": "Anchor query selects from file_type_stats",
            "status": "FAIL"
          },
          {
            "check": "Recursive step with UNION ALL",
            "status": "FAIL"
          },
          {
            "check": "Termination condition (hierarchy_level < 5)",
            "status": "FAIL"
          }
        ]
      },
      "query_title_uniqueness": {
        "fix": "Query title uniqueness",
        "status": "FAIL",
        "checks": [
          {
            "check": "Query 26 has unique title",
            "status": "FAIL",
            "expected_prefix": "Production-Grade File Type Hierarchy Analysis",
            "actual": "Production-Grade Item Kit Items with Recursive CTE and Advanced Analytics"
          },
          {
            "check": "Query 27 has unique title",
            "status": "FAIL",
            "expected_prefix": "Production-Grade Cumulative File Size Analysis",
            "actual": "Production-Grade Location Item Kit Pricing with Recursive CTE and Advanced Analy"
          },
          {
            "check": "Query 28 has unique title",
            "status": "FAIL",
            "expected_prefix": "Production-Grade Cross-Table File Relationship Analysis",
            "actual": "Production-Grade Employee Item Kit Pricing with Recursive CTE and Advanced Analy"
          },
          {
            "check": "Query 29 has unique title",
            "status": "FAIL",
            "expected_prefix": "Production-Grade Deeply Nested File Type Analysis",
            "actual": "Production-Grade Sales Item Kits Taxes with Recursive CTE and Advanced Analytics"
          },
          {
            "check": "Query 30 has unique title",
            "status": "FAIL",
            "expected_prefix": "Production-Grade Advanced Window Function Aggregation Analysis",
            "actual": "Production-Grade Employee Sales Items with Recursive CTE and Advanced Analytics"
          },
          {
            "check": "No duplicate titles",
            "status": "PASS"
          }
        ]
      },
      "header_formatting": {
        "fix": "Header formatting consistency",
        "status": "PASS",
        "checks": [
          {
            "check": "All queries use ## Query N: format",
            "status": "PASS",
            "count": 30
          },
          {
            "check": "No queries with --- prefix",
            "status": "PASS"
          }
        ]
      }
    },
    "overall_status": "FAIL"
  },
  "phase_2_syntax_validation": {
    "postgresql": {
      "available": false,
      "queries": []
    },
    "databricks": {
      "available": false,
      "queries": []
    },
    "databricks": {
      "available": false,
      "queries": []
    }
  },
  "phase_3_execution_testing": {
    "database": "db-5",
    "database_number": 5,
    "test_timestamp": "2026-02-03T20:37:52.639777",
    "postgresql": {
      "available": true,
      "queries": [
        {
          "query_number": 1,
          "description": "Query 1",
          "success": true,
          "execution_time_ms": 3.60107421875,
          "row_count": 0,
          "error": null,
          "error_type": null
        },
        {
          "query_number": 2,
          "description": "Query 2",
          "success": false,
          "execution_time_ms": 1.0559558868408203,
          "row_count": 0,
          "error": "column t.trans_date does not exist\nLINE 5:         COALESCE(CAST(t.trans_date AS TEXT), CAST(CURRENT_TI...\n                              ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 3,
          "description": "Query 3",
          "success": false,
          "execution_time_ms": 0.820159912109375,
          "row_count": 0,
          "error": "column t.item_unit_price does not exist\nLINE 6:         t.item_unit_price AS value,\n                ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 4,
          "description": "Query 4",
          "success": false,
          "execution_time_ms": 0.7040500640869141,
          "row_count": 0,
          "error": "column rc.sale_id does not exist\nLINE 20:         rc.sale_id,\n                 ^\nHINT:  Perhaps you meant to reference the column \"t.sale_id\".\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 5,
          "description": "Query 5",
          "success": false,
          "execution_time_ms": 0.6120204925537109,
          "row_count": 0,
          "error": "column rc.sale_id does not exist\nLINE 20:         rc.sale_id,\n                 ^\nHINT:  Perhaps you meant to reference the column \"t.sale_id\".\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 6,
          "description": "Query 6",
          "success": false,
          "execution_time_ms": 0.5979537963867188,
          "row_count": 0,
          "error": "column t.payment_id does not exist\nLINE 4:         t.payment_id,\n                ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 7,
          "description": "Query 7",
          "success": false,
          "execution_time_ms": 0.6079673767089844,
          "row_count": 0,
          "error": "column t.reorder_level does not exist\nLINE 6:         COALESCE(t.reorder_level, 0) AS value,\n                         ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 8,
          "description": "Query 8",
          "success": false,
          "execution_time_ms": 0.5381107330322266,
          "row_count": 0,
          "error": "column j.person_id does not exist\nLINE 12: ...  LEFT JOIN phppos_suppliers j ON t.supplier_id = j.person_i...\n                                                              ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 9,
          "description": "Query 9",
          "success": false,
          "execution_time_ms": 0.7441043853759766,
          "row_count": 0,
          "error": "column t.discount_percent does not exist\nLINE 6:         COALESCE(t.discount_percent, 0) AS value,\n                         ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 10,
          "description": "Query 10",
          "success": false,
          "execution_time_ms": 1.544952392578125,
          "row_count": 0,
          "error": "table name \"s\" specified more than once\n",
          "error_type": "DuplicateAlias"
        },
        {
          "query_number": 11,
          "description": "Query 11",
          "success": false,
          "execution_time_ms": 0.720977783203125,
          "row_count": 0,
          "error": "column t.payment_id does not exist\nLINE 4:         t.payment_id,\n                ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 12,
          "description": "Query 12",
          "success": false,
          "execution_time_ms": 0.8108615875244141,
          "row_count": 0,
          "error": "column t.person_id does not exist\nLINE 12:     LEFT JOIN phppos_customers j ON t.person_id = j.person_i...\n                                             ^\nHINT:  Perhaps you meant to reference the column \"j.person_id\".\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 13,
          "description": "Query 13",
          "success": false,
          "execution_time_ms": 0.7500648498535156,
          "row_count": 0,
          "error": "column t.employee_id does not exist\nLINE 12:     INNER JOIN phppos_employees j ON t.employee_id = j.perso...\n                                              ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 14,
          "description": "Query 14",
          "success": false,
          "execution_time_ms": 0.6101131439208984,
          "row_count": 0,
          "error": "column t.item_unit_price does not exist\nLINE 6:         t.item_unit_price AS value,\n                ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 15,
          "description": "Query 15",
          "success": false,
          "execution_time_ms": 0.8630752563476562,
          "row_count": 0,
          "error": "column t.item_unit_price does not exist\nLINE 6:         t.item_unit_price AS value,\n                ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 16,
          "description": "Query 16",
          "success": false,
          "execution_time_ms": 0.7822513580322266,
          "row_count": 0,
          "error": "column t.item_unit_price does not exist\nLINE 6:         t.item_unit_price AS value,\n                ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 17,
          "description": "Query 17",
          "success": false,
          "execution_time_ms": 0.7901191711425781,
          "row_count": 0,
          "error": "column t.audit_id does not exist\nLINE 4:         t.audit_id,\n                ^\nHINT:  Perhaps you meant to reference the column \"t.audit_time\".\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 18,
          "description": "Query 18",
          "success": false,
          "execution_time_ms": 0.80108642578125,
          "row_count": 0,
          "error": "column t.audit_id does not exist\nLINE 12:     INNER JOIN phppos_employees j ON t.audit_id = j.person_i...\n                                              ^\nHINT:  Perhaps you meant to reference the column \"t.audit_time\".\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 19,
          "description": "Query 19",
          "success": false,
          "execution_time_ms": 0.7951259613037109,
          "row_count": 0,
          "error": "column t.customer_id does not exist\nLINE 12:     LEFT JOIN phppos_customers j ON t.customer_id = j.person...\n                                             ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 20,
          "description": "Query 20",
          "success": false,
          "execution_time_ms": 0.7078647613525391,
          "row_count": 0,
          "error": "column t.employee_id does not exist\nLINE 12:     LEFT JOIN phppos_employees j ON t.employee_id = j.person...\n                                             ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 21,
          "description": "Query 21",
          "success": false,
          "execution_time_ms": 0.6659030914306641,
          "row_count": 0,
          "error": "column t.employee_id does not exist\nLINE 12:     LEFT JOIN phppos_employees j ON t.employee_id = j.person...\n                                             ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 22,
          "description": "Query 22",
          "success": false,
          "execution_time_ms": 0.7109642028808594,
          "row_count": 0,
          "error": "column t.person_id does not exist\nLINE 12:     LEFT JOIN phppos_people j ON t.person_id = j.person_id\n                                          ^\nHINT:  Perhaps you meant to reference the column \"j.person_id\".\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 23,
          "description": "Query 23",
          "success": false,
          "execution_time_ms": 0.5817413330078125,
          "row_count": 0,
          "error": "column t.discount_percent does not exist\nLINE 6:         COALESCE(t.discount_percent, 0) AS value,\n                         ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 24,
          "description": "Query 24",
          "success": false,
          "execution_time_ms": 0.5540847778320312,
          "row_count": 0,
          "error": "column t.id does not exist\nLINE 12:     INNER JOIN phppos_location_items j ON t.id = j.id\n                                                   ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 25,
          "description": "Query 25",
          "success": false,
          "execution_time_ms": 0.6783008575439453,
          "row_count": 0,
          "error": "column t.employee_id does not exist\nLINE 12: ...pos_employee_items j ON t.item_id = j.item_id AND t.employee...\n                                                              ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 26,
          "description": "Query 26",
          "success": false,
          "execution_time_ms": 0.7898807525634766,
          "row_count": 0,
          "error": "column t.reorder_level does not exist\nLINE 6:         COALESCE(t.reorder_level, 0) AS value,\n                         ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 27,
          "description": "Query 27",
          "success": false,
          "execution_time_ms": 0.6730556488037109,
          "row_count": 0,
          "error": "column t.item_unit_price does not exist\nLINE 6:         t.item_unit_price AS value,\n                ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 28,
          "description": "Query 28",
          "success": false,
          "execution_time_ms": 0.6191730499267578,
          "row_count": 0,
          "error": "column t.item_unit_price does not exist\nLINE 6:         t.item_unit_price AS value,\n                ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 29,
          "description": "Query 29",
          "success": false,
          "execution_time_ms": 0.759124755859375,
          "row_count": 0,
          "error": "column t.discount_percent does not exist\nLINE 6:         COALESCE(t.discount_percent, 0) AS value,\n                         ^\n",
          "error_type": "UndefinedColumn"
        },
        {
          "query_number": 30,
          "description": "Query 30",
          "success": false,
          "execution_time_ms": 0.7851123809814453,
          "row_count": 0,
          "error": "column t.item_unit_price does not exist\nLINE 6:         t.item_unit_price AS value,\n                ^\n",
          "error_type": "UndefinedColumn"
        }
      ],
      "statistics": {
        "total_queries": 30,
        "successful": 1,
        "failed": 29,
        "success_rate": 3.3333333333333335,
        "avg_execution_time_ms": 3.60107421875,
        "total_rows_returned": 0
      }
    },
    "databricks": {
      "available": true,
      "queries": []
    }
  },
  "phase_4_comprehensive_evaluation": {
    "query_count": {
      "requirement": "Exactly 30 queries",
      "found": 30,
      "status": "PASS",
      "message": "Found 30 queries, expected 30"
    },
    "recursive_cte_usage": {
      "requirement": "Queries claiming recursive CTE must have WITH RECURSIVE",
      "total_queries": 30,
      "queries_with_recursive": 30,
      "mismatched": 0,
      "status": "PASS",
      "details": [
        {
          "query_number": 1,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 2,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 3,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 4,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 5,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 6,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 7,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 8,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 9,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 10,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 11,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 12,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 13,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 14,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 15,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 16,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 17,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 18,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 19,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 20,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 21,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 22,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 23,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 24,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 25,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 26,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 27,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 28,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 29,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        },
        {
          "query_number": 30,
          "has_recursive": true,
          "claims_recursive": true,
          "status": "PASS"
        }
      ],
      "mismatched_queries": []
    },
    "cte_usage": {
      "requirement": "All queries must use CTEs",
      "total_queries": 30,
      "queries_with_cte": 30,
      "queries_without_cte": 0,
      "status": "PASS",
      "queries_without_cte_list": []
    },
    "complexity": {
      "requirement": "Queries must demonstrate high complexity",
      "complexity_scores": [
        {
          "query_number": 1,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 4,
          "window_function_count": 12,
          "aggregation_count": 17,
          "subquery_count": 6
        },
        {
          "query_number": 2,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 2,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 3,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 4,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 4,
          "window_function_count": 15,
          "aggregation_count": 16,
          "subquery_count": 5
        },
        {
          "query_number": 5,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 4,
          "window_function_count": 15,
          "aggregation_count": 16,
          "subquery_count": 5
        },
        {
          "query_number": 6,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 7,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 8,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 9,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 4,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 10,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 4,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 11,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 1,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 12,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 13,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 4,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 14,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 15,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 16,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 17,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 16,
          "subquery_count": 5
        },
        {
          "query_number": 18,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 19,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 20,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 21,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 22,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 23,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 24,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 25,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 26,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 27,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 28,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 3,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 29,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 4,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        },
        {
          "query_number": 30,
          "cte_count": 1,
          "recursive_cte_count": 1,
          "join_count": 4,
          "window_function_count": 12,
          "aggregation_count": 13,
          "subquery_count": 2
        }
      ],
      "average_cte_count": 1.0,
      "average_join_count": 3.1666666666666665,
      "average_window_function_count": 12.2
    }
  },
  "findings": {
    "critical_issues": [
      {
        "phase": "Fix Verification",
        "issue": "Some fixes were not applied correctly",
        "details": {
          "query_2_array_syntax": {
            "query_number": 2,
            "fix": "Array slicing syntax replacement",
            "status": "FAIL",
            "checks": [
              {
                "check": "path_preview_cte CTE exists",
                "status": "FAIL"
              },
              {
                "check": "No array slicing syntax [start:end]",
                "status": "PASS"
              },
              {
                "check": "ARRAY_LENGTH bounds checking present",
                "status": "FAIL"
              },
              {
                "check": "FROM clause uses path_preview_cte",
                "status": "PASS"
              }
            ]
          },
          "query_26_recursive_cte": {
            "query_number": 26,
            "fix": "Recursive CTE addition",
            "status": "FAIL",
            "checks": [
              {
                "check": "WITH RECURSIVE present for recursive CTE",
                "status": "FAIL"
              },
              {
                "check": "Anchor query selects from file_type_stats",
                "status": "FAIL"
              },
              {
                "check": "Recursive step with UNION ALL",
                "status": "FAIL"
              },
              {
                "check": "Termination condition (hierarchy_level < 5)",
                "status": "FAIL"
              }
            ]
          },
          "query_title_uniqueness": {
            "fix": "Query title uniqueness",
            "status": "FAIL",
            "checks": [
              {
                "check": "Query 26 has unique title",
                "status": "FAIL",
                "expected_prefix": "Production-Grade File Type Hierarchy Analysis",
                "actual": "Production-Grade Item Kit Items with Recursive CTE and Advanced Analytics"
              },
              {
                "check": "Query 27 has unique title",
                "status": "FAIL",
                "expected_prefix": "Production-Grade Cumulative File Size Analysis",
                "actual": "Production-Grade Location Item Kit Pricing with Recursive CTE and Advanced Analy"
              },
              {
                "check": "Query 28 has unique title",
                "status": "FAIL",
                "expected_prefix": "Production-Grade Cross-Table File Relationship Analysis",
                "actual": "Production-Grade Employee Item Kit Pricing with Recursive CTE and Advanced Analy"
              },
              {
                "check": "Query 29 has unique title",
                "status": "FAIL",
                "expected_prefix": "Production-Grade Deeply Nested File Type Analysis",
                "actual": "Production-Grade Sales Item Kits Taxes with Recursive CTE and Advanced Analytics"
              },
              {
                "check": "Query 30 has unique title",
                "status": "FAIL",
                "expected_prefix": "Production-Grade Advanced Window Function Aggregation Analysis",
                "actual": "Production-Grade Employee Sales Items with Recursive CTE and Advanced Analytics"
              },
              {
                "check": "No duplicate titles",
                "status": "PASS"
              }
            ]
          },
          "header_formatting": {
            "fix": "Header formatting consistency",
            "status": "PASS",
            "checks": [
              {
                "check": "All queries use ## Query N: format",
                "status": "PASS",
                "count": 30
              },
              {
                "check": "No queries with --- prefix",
                "status": "PASS"
              }
            ]
          }
        }
      }
    ],
    "warnings": [
      {
        "issue": "Limited database availability for syntax validation",
        "available_databases": [],
        "recommendation": "Set up database connections for full cross-database validation"
      }
    ],
    "recommendations": [
      "All critical fixes have been applied successfully",
      "Query titles are unique across all 30 queries",
      "Header formatting is consistent",
      "30 queries use recursive CTEs",
      "Consider adding WITH RECURSIVE to queries 16-25 that claim recursive CTE in titles",
      "Set up database connections for full syntax and execution testing"
    ]
  }
}
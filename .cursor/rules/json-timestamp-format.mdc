---
description: Timestamp format requirement for all JSON files generated by validation suite
alwaysApply: true
---

# JSON Timestamp Format Requirement

## Overview

**MANDATORY**: All JSON files generated by the validation suite must include timestamps in **EST (Eastern Standard Time)** timezone using the format **YYYYMMDD-HHMM**.

## Format Specification

- **Format**: `YYYYMMDD-HHMM`
- **Timezone**: EST (US/Eastern) - automatically handles EST/EDT transitions
- **Example**: `20260203-1430` represents February 3, 2026 at 2:30 PM EST
- **Length**: Exactly 13 characters (8 digits + hyphen + 4 digits)

## Required Timestamp Fields

All validation JSON files must include timestamp fields using this format:

- `validation_date`: Overall validation timestamp
- `extraction_timestamp`: Query extraction timestamp (for queries.json)
- `verification_date`: Fix verification timestamp
- `report_date`: Report generation timestamp
- `start_time`: Phase start time
- `end_time`: Phase end time
- `test_date`: Test execution date
- Any other timestamp fields in validation outputs

## Implementation

### Utility Function

Use the provided utility function for consistent timestamp generation:

```python

# Import timestamp utility

try:
    from timestamp_utils import get_est_timestamp
except ImportError:
    # If running from db-{N}/scripts/, import from root
    import sys
    from pathlib import Path
    root_scripts = Path(__file__).parent.parent.parent / 'scripts'
    sys.path.insert(0, str(root_scripts))
    from timestamp_utils import get_est_timestamp

# Use in JSON generation

result = {
    'validation_date': get_est_timestamp(),  # Returns: '20260203-1430' (EST)
    'start_time': get_est_timestamp(),
    # ... other fields
}
```

### Utility Location

The timestamp utility is located at:
- `scripts/timestamp_utils.py` (root level)
- Can be imported from `db-{N}/scripts/` directories via path manipulation

### Dependencies

The utility requires `pytz` package for accurate timezone handling:
```bash
pip install pytz>=2023.3
```

The utility includes a fallback if `pytz` is not available, but `pytz` is recommended for accurate EST/EDT handling.

## Files Affected

All validation scripts that generate JSON files must use this format:

### Root Scripts

- `scripts/extract_queries_to_json.py` - `extraction_timestamp`
- `scripts/validate.py` - `validation_date`, `start_time`, `end_time`

### Database-Specific Scripts

- `db-{N}/scripts/verify_fixes.py` - `verification_date`
- `db-{N}/scripts/comprehensive_validator.py` - `validation_date`
- `db-{N}/scripts/generate_final_report.py` - `report_date`
- `db-{N}/scripts/execution_tester.py` - `test_date` (if applicable)

## Example Timestamps

- `20260203-1430` - February 3, 2026 at 2:30 PM EST
- `20260203-0915` - February 3, 2026 at 9:15 AM EST
- `20260203-2359` - February 3, 2026 at 11:59 PM EST
- `20260204-0001` - February 4, 2026 at 12:01 AM EST

## Validation

All validation scripts must:
1. Import `get_est_timestamp` from `timestamp_utils`
2. Use `get_est_timestamp()` for all timestamp fields
3. Never use `datetime.now().isoformat()` or other timestamp formats
4. Ensure timestamps are in EST timezone (not UTC or local time)

## Timezone Handling

The utility automatically handles:
- **EST (Eastern Standard Time)**: UTC-5 (November - March)
- **EDT (Eastern Daylight Time)**: UTC-4 (March - November)
- **DST Transitions**: Automatically adjusts for daylight saving time

## Related Rules

- See `.cursor/rules/query-validation-suite.mdc` for complete validation suite documentation
- See `.cursor/rules/query-abstraction-requirement.mdc` for query abstraction requirements

---
**Last Updated**: 2026-02-03
**Version**: 1.0

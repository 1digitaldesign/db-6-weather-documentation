openapi: 3.0.3
info:
  title: Database db-10 - Database API Specification
  description: "This database implements a comprehensive marketing intelligence system\
    \ with full Brickseek.com functionality for retail inventory tracking, pricing\
    \ intelligence, and deal discovery. The database integrates data from U.S. government\
    \ sources (Census Bureau MRTS, BLS CPI/PPI, FTC consumer data) and other reputable\
    \ sources, providing real-time pricing comparisons, inventory availability tracking,\
    \ market trend analysis, and deal alert generation.\n\n- Product Catalog Management:\
    \ Comprehensive product tracking with SKUs, UPCs, categories, brands, and detailed\
    \ product information\n- Retailer Intelligence: Multi-retailer tracking with store\
    \ locations, market coverage, and competitive positioning\n- Pricing Intelligence:\
    \ Historical pricing tracking with deal detection, price comparison, and market\
    \ positioning analysis\n- Inventory Tracking: Real-time inventory levels by store\
    \ with stock status and availability metrics\n- Market Intelligence: Aggregated\
    \ market data for competitive analysis, market share, and trend forecasting\n\
    - Deal Discovery: Automated deal detection and alert generation for promotions,\
    \ sales, and clearance events\n- Government Data Integration: Census Bureau retail\
    \ trade data, BLS price indices, and FTC consumer complaint data\n- Spatial Analysis:\
    \ Geographic market analysis with store location mapping and market area definitions\n\
    - Data Lineage: Complete source tracking and data quality scoring for all data\
    \ sources\n\n- PostgreSQL: Full support with PostGIS for spatial data (GEOGRAPHY\
    \ types)\n\nThis database powers a marketing intelligence platform sourced from\
    \ businesses with at least $1M ARR per year. The queries demonstrate production-grade\
    \ patterns used by:\n- Brickseek.com: Retail inventory tracking and pricing intelligence\n\
    - Honey: Price tracking and deal discovery\n- CamelCamelCamel: Amazon price history\
    \ and deal alerts\n- RetailMeNot: Coupon and deal aggregation\n- PriceGrabber:\
    \ Price comparison and market intelligence\n\n- U.S. Census Bureau: Monthly Retail\
    \ Trade Survey (MRTS), Advance Retail Inventories\n- BLS Public Data API: Consumer\
    \ Price Index (CPI), Producer Price Index (PPI)\n- Federal Trade Commission: Consumer\
    \ complaint data, pricing accuracy studies\n- Data.gov: Retail datasets, economic\
    \ indicators, consumer data\n- Retail APIs: Product catalogs, pricing, inventory\
    \ data\n\n- Target Size: 1 GB of real data from public sources\n- Products: ~10,000\
    \ products across major categories\n- Retailers: 20-30 major retailers\n- Stores:\
    \ ~5,000 store locations\n- Pricing History: Daily snapshots for 2 years (~7.3M\
    \ records)\n- Inventory Data: Weekly snapshots for 1 year (~2.6M records)\n- Government\
    \ Data: Monthly/quarterly data from Census, BLS, FTC\n\n---\n\n---\n\nThis section\
    \ provides a comprehensive data dictionary for all tables in the database, including\
    \ column names, data types, constraints, and descriptions. Tables are organized\
    \ by functional category for easier navigation.\n\nThe Marketing Intelligence\
    \ Database consists of 12 main tables designed to store products, retailers, stores,\
    \ inventory, pricing, market intelligence, deals, and government economic data.\
    \ The database supports spatial analysis with GEOGRAPHY types for store locations\
    \ and market boundaries.\n\n1. Product Management: `products`\n2. Retailer Management:\
    \ `retailers`, `stores`\n3. Inventory & Pricing: `product_inventory`, `product_pricing`\n\
    4. Market Intelligence: `market_intelligence`, `deal_alerts`\n5. Government Data:\
    \ `census_retail_data`, `bls_price_data`\n6. Geographic Data: `geographic_markets`\n\
    7. Data Management: `data_sources`, `pipeline_metadata`\n\nProduct catalog with\
    \ SKUs, UPCs, categories, and brand information.\n\nKey Columns:\n- `product_id`\
    \ (VARCHAR, PK): Unique identifier for each product\n- `sku` (VARCHAR, UNIQUE):\
    \ Stock Keeping Unit identifier\n- `upc` (VARCHAR, UNIQUE): Universal Product\
    \ Code (barcode)\n- `product_name` (VARCHAR): Product name/title\n- `brand` (VARCHAR):\
    \ Brand name\n- `category` (VARCHAR): Product category\n- `subcategory` (VARCHAR):\
    \ Product subcategory\n- `is_active` (BOOLEAN): Whether product is currently active\n\
    \nRetailer information including headquarters and market coverage.\n\nKey Columns:\n\
    - `retailer_id` (VARCHAR, PK): Unique identifier for each retailer\n- `retailer_name`\
    \ (VARCHAR, UNIQUE): Retailer name\n- `retailer_type` (VARCHAR): Type: 'big_box',\
    \ 'department_store', 'online', 'specialty', 'discount'\n- `market_coverage` (VARCHAR):\
    \ Coverage: 'national', 'regional', 'local', 'international'\n- `retailer_status`\
    \ (VARCHAR): Status: 'active', 'inactive', 'bankrupt'\n\nStore locations with\
    \ geographic data for spatial analysis.\n\nKey Columns:\n- `store_id` (VARCHAR,\
    \ PK): Unique identifier for each store\n- `retailer_id` (VARCHAR, FK): Reference\
    \ to retailers table\n- `store_name` (VARCHAR): Store name\n- `store_address`\
    \ (VARCHAR): Store address\n- `store_city`, `store_state`, `store_zip` (VARCHAR):\
    \ Location details\n- `store_latitude`, `store_longitude` (NUMERIC): Geographic\
    \ coordinates\n- `store_geom` (GEOGRAPHY): Point geometry for store location (spatial)\n\
    - `store_type` (VARCHAR): Type: 'supercenter', 'neighborhood', 'express', 'warehouse'\n\
    - `store_status` (VARCHAR): Status: 'open', 'closed', 'temporary_closed'\n\nInventory\
    \ levels by store with stock status tracking.\n\nKey Columns:\n- `inventory_id`\
    \ (VARCHAR, PK): Unique identifier for each inventory record\n- `product_id` (VARCHAR,\
    \ FK): Reference to products table\n- `store_id` (VARCHAR, FK): Reference to stores\
    \ table\n- `stock_level` (INTEGER): Current stock level\n- `stock_status` (VARCHAR):\
    \ Status: 'in_stock', 'out_of_stock', 'low_stock', 'limited_availability'\n- `available_quantity`\
    \ (INTEGER): Available quantity\n- `last_checked_at` (TIMESTAMP_NTZ): Last inventory\
    \ check timestamp\n- `last_restocked_at` (TIMESTAMP_NTZ): Last restock timestamp\n\
    - `confidence_score` (NUMERIC): Data quality confidence (0-100)\n\nPricing data\
    \ with historical tracking and deal detection.\n\nKey Columns:\n- `pricing_id`\
    \ (VARCHAR, PK): Unique identifier for each pricing record\n- `product_id` (VARCHAR,\
    \ FK): Reference to products table\n- `retailer_id` (VARCHAR, FK): Reference to\
    \ retailers table\n- `store_id` (VARCHAR, FK, nullable): Reference to stores table\
    \ (null for online-only pricing)\n- `current_price` (NUMERIC): Current price\n\
    - `original_price` (NUMERIC): Original/regular price\n- `sale_price` (NUMERIC):\
    \ Sale price\n- `discount_percentage` (NUMERIC): Discount percentage\n- `price_effective_date`\
    \ (TIMESTAMP_NTZ): Price effective date\n- `price_expiry_date` (TIMESTAMP_NTZ):\
    \ Price expiry date\n- `price_type` (VARCHAR): Type: 'regular', 'sale', 'clearance',\
    \ 'promotional'\n- `is_online_price` (BOOLEAN): Whether this is an online price\n\
    \nAggregated market data for competitive analysis and trends.\n\nKey Columns:\n\
    - `intelligence_id` (VARCHAR, PK): Unique identifier for each intelligence record\n\
    - `product_id` (VARCHAR, FK): Reference to products table\n- `market_area` (VARCHAR):\
    \ Market area identifier (ZIP, city, state, or 'national')\n- `market_type` (VARCHAR):\
    \ Type: 'zip', 'city', 'state', 'msa', 'national'\n- `average_price` (NUMERIC):\
    \ Average market price\n- `price_range_min` (NUMERIC): Minimum price in market\n\
    - `price_range_max` (NUMERIC): Maximum price in market\n- `availability_rate`\
    \ (NUMERIC): Percentage of stores with product in stock\n- `market_share` (NUMERIC):\
    \ Market share percentage\n- `competitor_count` (INTEGER): Number of competitors\n\
    - `intelligence_date` (DATE): Intelligence date\n- `data_quality_score` (NUMERIC):\
    \ Data quality score\n\nDeal tracking and alert generation for promotions and\
    \ sales.\n\nKey Columns:\n- `deal_id` (VARCHAR, PK): Unique identifier for each\
    \ deal\n- `product_id` (VARCHAR, FK): Reference to products table\n- `retailer_id`\
    \ (VARCHAR, FK): Reference to retailers table\n- `store_id` (VARCHAR, FK, nullable):\
    \ Reference to stores table (null for online deals)\n- `discount_percentage` (NUMERIC):\
    \ Discount percentage\n- `deal_start_date` (TIMESTAMP_NTZ): Deal start date\n\
    - `deal_end_date` (TIMESTAMP_NTZ): Deal end date\n- `deal_type` (VARCHAR): Type:\
    \ 'sale', 'clearance', 'promotion', 'flash_sale'\n- `is_active` (BOOLEAN): Whether\
    \ deal is currently active\n\nU.S. Census Bureau Monthly Retail Trade Survey (MRTS)\
    \ data.\n\nKey Columns:\n- `census_id` (VARCHAR, PK): Unique identifier for each\
    \ census record\n- `naics_code` (VARCHAR): NAICS industry code\n- `time_period`\
    \ (VARCHAR): Time period (YYYY-MM format)\n- `cell_value` (NUMERIC): Data value\
    \ (sales, inventory, etc.)\n- `source` (VARCHAR): Data source identifier\n- `extracted_date`\
    \ (TIMESTAMP_NTZ): Data extraction timestamp\n\nBLS Consumer Price Index (CPI)\
    \ and Producer Price Index (PPI) data.\n\nKey Columns:\n- `bls_id` (VARCHAR, PK):\
    \ Unique identifier for each BLS record\n- `series_id` (VARCHAR): BLS series identifier\n\
    - `year` (INTEGER): Year\n- `period` (VARCHAR): Period (month code: M01-M12)\n\
    - `value` (NUMERIC): Price index value\n- `source` (VARCHAR): Data source identifier\n\
    - `extracted_date` (TIMESTAMP_NTZ): Data extraction timestamp\n\nMarket area definitions\
    \ with demographics and spatial boundaries.\n\nKey Columns:\n- `market_id` (VARCHAR,\
    \ PK): Unique identifier for each market\n- `market_type` (VARCHAR): Type: 'zip',\
    \ 'city', 'state', 'msa', 'national'\n- `market_name` (VARCHAR): Market name\n\
    - `market_code` (VARCHAR): Market code (ZIP, city name, state code, etc.)\n- `market_boundary`\
    \ (GEOGRAPHY): Polygon geometry for market boundary (spatial)\n- `population`\
    \ (INTEGER): Market population\n- `median_income` (NUMERIC): Median household\
    \ income\n- `demographics_json` (VARCHAR): Additional demographics as JSON\n\n\
    Source tracking for data lineage and quality management.\n\nKey Columns:\n- `source_id`\
    \ (VARCHAR, PK): Unique identifier for each data source\n- `source_name` (VARCHAR):\
    \ Source name\n- `source_type` (VARCHAR): Type: 'api', 'scraper', 'manual', 'government'\n\
    - `source_url` (VARCHAR): Source URL or endpoint\n- `update_frequency` (VARCHAR):\
    \ Update frequency\n- `last_successful_extraction` (TIMESTAMP_NTZ): Last successful\
    \ extraction timestamp\n- `data_quality_score` (NUMERIC): Overall data quality\
    \ score\n\nETL pipeline execution tracking and performance metrics.\n\nKey Columns:\n\
    - `pipeline_id` (VARCHAR, PK): Unique identifier for each pipeline run\n- `pipeline_name`\
    \ (VARCHAR): Pipeline name\n- `execution_start_time` (TIMESTAMP_NTZ): Execution\
    \ start timestamp\n- `execution_end_time` (TIMESTAMP_NTZ): Execution end timestamp\n\
    - `status` (VARCHAR): Status: 'success', 'failed', 'partial'\n- `records_processed`\
    \ (INTEGER): Number of records processed\n- `error_message` (VARCHAR): Error message\
    \ if failed\n\n---\n\n---\n\n---\n\nThis database includes 30 production SQL queries,\
    \ each designed to solve specific business problems for companies with $1M+ ARR.\
    \ Each query includes:\n\n- Business Use Case: The specific business problem this\
    \ query solves\n- Description: Technical explanation of what the query does\n\
    - Client Deliverable: What output or report this query generates\n- Business Value:\
    \ The business impact and value delivered\n- Complexity: Technical complexity\
    \ indicators\n- SQL Code: Complete, production-ready SQL query\n\n---\n\nUse Case:\
    \ Competitive pricing analysis for retail intelligence platforms - identify best\
    \ prices by location and track price trends over time\n\nDescription: Analyzes\
    \ pricing across multiple retailers for products within geographic markets, incorporating\
    \ temporal trends, price volatility metrics, and competitive positioning. Uses\
    \ multiple CTEs to aggregate pricing data, calculate price differences, identify\
    \ best deals, and track price movements over time with window functions.\n\nUse\
    \ Case: Competitive pricing analysis for retail intelligence platforms - identify\
    \ best prices by location and track price trends over time\n\nBusiness Value:\
    \ Enables retailers and consumers to identify optimal pricing strategies and best\
    \ deals by geographic market, supporting $1M+ ARR pricing intelligence platforms\n\
    \nPurpose: Provides comprehensive multi-retailer price comparison with geographic\
    \ and temporal dimensions for strategic pricing decisions\n\nComplexity: Deep\
    \ nested CTEs (6+ levels), multiple joins across products/retailers/stores/pricing\
    \ tables, window functions with frame clauses, percentile calculations, temporal\
    \ aggregations, geographic filtering, correlated subqueries\n\nExpected Output:\
    \ Product pricing comparison report showing best prices by retailer and location,\
    \ price trends, and competitive positioning metrics\n\n---\n\nUse Case: Inventory\
    \ forecasting for retail operations - predict when products will be in stock and\
    \ optimize restocking schedules\n\nDescription: Predicts inventory availability\
    \ by analyzing historical stock patterns, restocking frequencies, seasonal trends,\
    \ and geographic distribution. Uses recursive CTEs for pattern detection, window\
    \ functions for trend analysis, and complex aggregations to forecast stock levels.\n\
    \nUse Case: Inventory forecasting for retail operations - predict when products\
    \ will be in stock and optimize restocking schedules\n\nBusiness Value: Enables\
    \ retailers to optimize inventory management, reduce stockouts, and improve customer\
    \ satisfaction, supporting $1M+ ARR inventory intelligence platforms\n\nPurpose:\
    \ Provides predictive analytics for inventory availability based on historical\
    \ patterns and geographic factors\n\nComplexity: Recursive CTEs for pattern detection,\
    \ multiple CTEs (7+ levels), window functions with complex frame clauses, temporal\
    \ aggregations, geographic clustering, statistical forecasting calculations\n\n\
    Expected Output: Inventory availability predictions with confidence scores, restocking\
    \ recommendations, and geographic distribution analysis\n\n---\n\nUse Case: Competitive\
    \ market analysis for retail intelligence - identify market leaders, track share\
    \ changes, and analyze competitive dynamics\n\nDescription: Analyzes market share\
    \ by retailer and product category, incorporating competitive positioning metrics,\
    \ temporal trends, and geographic distribution. Uses multiple CTEs to calculate\
    \ market share percentages, competitive rankings, share changes over time, and\
    \ market concentration metrics with window functions.\n\nUse Case: Competitive\
    \ market analysis for retail intelligence - identify market leaders, track share\
    \ changes, and analyze competitive dynamics\n\nBusiness Value: Enables retailers\
    \ to understand their market position, track competitive movements, and identify\
    \ growth opportunities, supporting $1M+ ARR market intelligence platforms\n\n\
    Purpose: Provides comprehensive market share analysis with competitive positioning\
    \ and temporal trend tracking\n\nComplexity: Multiple CTEs (6+ levels), complex\
    \ aggregations, window functions with frame clauses, percentile rankings, temporal\
    \ comparisons, market concentration calculations\n\nExpected Output: Market share\
    \ report showing retailer rankings, share percentages, competitive positioning,\
    \ and temporal trends by product category\n\n---\n\nUse Case: Automated deal detection\
    \ for retail intelligence platforms\n\nDescription: Detects deals and generates\
    \ alerts by analyzing price changes, discount patterns, and temporal trends. Uses\
    \ recursive CTEs for pattern detection, window functions for trend analysis, and\
    \ complex aggregations to identify optimal deals.\n\nUse Case: Automated deal\
    \ detection for retail intelligence platforms\n\nBusiness Value: Enables consumers\
    \ and retailers to identify best deals automatically, supporting $1M+ ARR deal\
    \ aggregation platforms\n\nPurpose: Provides comprehensive analysis for marketing\
    \ intelligence\n\nComplexity: Recursive CTEs, multiple CTEs (7+ levels), window\
    \ functions with frame clauses, temporal pattern detection, discount analysis\n\
    \nExpected Output: Detailed analysis report with metrics and insights\n\n---\n\
    \nUse Case: Category performance analysis for retail strategy\n\nDescription:\
    \ Analyzes product category trends with seasonal decomposition, identifying cyclical\
    \ patterns, growth trends, and category performance metrics. Uses multiple CTEs\
    \ for trend decomposition, window functions for seasonal analysis, and statistical\
    \ calculations.\n\nUse Case: Category performance analysis for retail strategy\n\
    \nBusiness Value: Enables retailers to understand category trends and optimize\
    \ product mix, supporting $1M+ ARR retail analytics platforms\n\nPurpose: Provides\
    \ comprehensive analysis for marketing intelligence\n\nComplexity: Multiple CTEs\
    \ (8+ levels), seasonal decomposition, window functions with RANGE frames, trend\
    \ analysis, statistical calculations\n\nExpected Output: Detailed analysis report\
    \ with metrics and insights\n\n---\n\nUse Case: Marketing intelligence for retail\
    \ operations\n\nDescription: Comprehensive marketing intelligence analysis with\
    \ multiple CTEs, window functions, and complex aggregations.\n\nUse Case: Marketing\
    \ intelligence for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing\
    \ intelligence platforms\n\nPurpose: Provides detailed marketing intelligence\
    \ analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions, complex\
    \ aggregations\n\nExpected Output: Analysis report with comprehensive metrics\n\
    \n---\n\nUse Case: Marketing intelligence for retail operations\n\nDescription:\
    \ Comprehensive marketing intelligence analysis with multiple CTEs, window functions,\
    \ and complex aggregations.\n\nUse Case: Marketing intelligence for retail operations\n\
    \nBusiness Value: Supports $1M+ ARR marketing intelligence platforms\n\nPurpose:\
    \ Provides detailed marketing intelligence analysis\n\nComplexity: Multiple CTEs\
    \ (6+ levels), window functions, complex aggregations\n\nExpected Output: Analysis\
    \ report with comprehensive metrics\n\n---\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nDescription: Comprehensive marketing intelligence analysis\
    \ with multiple CTEs, window functions, and complex aggregations.\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nBusiness Value: Supports $1M+\
    \ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\nUse Case: Marketing intelligence for retail operations\n\n\
    Description: Comprehensive marketing intelligence analysis with multiple CTEs,\
    \ window functions, and complex aggregations.\n\nUse Case: Marketing intelligence\
    \ for retail operations\n\nBusiness Value: Supports $1M+ ARR marketing intelligence\
    \ platforms\n\nPurpose: Provides detailed marketing intelligence analysis\n\n\
    Complexity: Multiple CTEs (6+ levels), window functions, complex aggregations\n\
    \nExpected Output: Analysis report with comprehensive metrics\n\n---\n\nUse Case:\
    \ Marketing intelligence for retail operations\n\nDescription: Comprehensive marketing\
    \ intelligence analysis with multiple CTEs, window functions, and complex aggregations.\n\
    \nUse Case: Marketing intelligence for retail operations\n\nBusiness Value: Supports\
    \ $1M+ ARR marketing intelligence platforms\n\nPurpose: Provides detailed marketing\
    \ intelligence analysis\n\nComplexity: Multiple CTEs (6+ levels), window functions,\
    \ complex aggregations\n\nExpected Output: Analysis report with comprehensive\
    \ metrics\n\n---\n\n1. PostgreSQL Setup:\n   \n\n   - Use Delta Lake format\n\
    \   - Load schema.sql (adapting GEOGRAPHY types as needed)\n\n   - Create database\
    \ and schema\n   - Load schema.sql (GEOGRAPHY types supported)\n\nRun the ETL\
    \ pipeline to extract data from government APIs:\n\nOr use the bulk download script:\n\
    \nAll queries are located in `queries/queries.md` and can be executed directly\
    \ on any supported database platform.\n\nRun the validation suite:\n\nOr use the\
    \ validate command:\n\n---\n\nLast Updated: 2026-02-04\n\n---\n\nAll queries in\
    \ this database are designed to work across multiple database platforms:\n\n-\
    \ PostgreSQL: Full support with standard SQL features\n\nQueries use standard\
    \ SQL syntax and avoid platform-specific features to ensure compatibility.\n\n\
    ---\n\nDocument Information:\n\n- Generated: 20260210-0115\n- Database: db-10\n\
    - Type: Marketing Intelligence Database\n- Queries: 30 production queries\n- Status:\
    \ âœ… Complete Comprehensive Deliverable"
  version: 1.0.0
  contact:
    name: Database Team
  license:
    name: MIT
servers:
- url: postgresql://localhost:5432/db_10
  description: PostgreSQL Server with PostGIS
tags:
- name: schema
  description: Database schema information
- name: tables
  description: Table definitions and structures
- name: spatial
  description: Spatial data types and operations
- name: queries
  description: SQL query definitions and metadata
- name: relationships
  description: Table relationships and foreign keys
paths:
  /schema:
    get:
      tags:
      - schema
      summary: Get database schema overview
      description: Returns overview information about the database schema
      responses:
        '200':
          description: Schema overview
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SchemaOverview'
  /tables:
    get:
      tags:
      - tables
      summary: List all tables
      description: Returns a list of all tables in the database
      responses:
        '200':
          description: List of tables
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Table'
  /tables/{tableName}:
    get:
      tags:
      - tables
      summary: Get table details
      description: Returns detailed information about a specific table
      parameters:
      - name: tableName
        in: path
        required: true
        schema:
          type: string
        description: Name of the table
      responses:
        '200':
          description: Table details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Table'
  /queries:
    get:
      tags:
      - queries
      summary: List all SQL queries
      description: Returns metadata for all SQL queries
      responses:
        '200':
          description: List of queries
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Query'
  /queries/{queryNumber}:
    get:
      tags:
      - queries
      summary: Get query details
      description: Returns detailed information and SQL code for a specific query
      parameters:
      - name: queryNumber
        in: path
        required: true
        schema:
          type: integer
        description: Query number (1-30)
      responses:
        '200':
          description: Query details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Query'
  /spatial/operations:
    get:
      tags:
      - spatial
      summary: List spatial operations
      description: Returns available spatial operations and functions
      responses:
        '200':
          description: List of spatial operations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SpatialOperation'
components:
  schemas:
    SchemaOverview:
      type: object
      properties:
        database_name:
          type: string
          example: db-1
        database_type:
          type: string
          example: Chat/Messaging System
        created_date:
          type: string
          format: date
          example: '2026-02-03'
        total_tables:
          type: integer
          example: 11
        supported_platforms:
          type: array
          items:
            type: string
          example:
          - PostgreSQL
        table_groups:
          type: array
          items:
            $ref: '#/components/schemas/TableGroup'
    TableGroup:
      type: object
      properties:
        name:
          type: string
          example: User Management
        tables:
          type: array
          items:
            type: string
          example:
          - profiles
    Table:
      type: object
      required:
      - name
      - columns
      properties:
        name:
          type: string
          example: profiles
        description:
          type: string
          example: Stores user profile information
        columns:
          type: array
          items:
            $ref: '#/components/schemas/Column'
        indexes:
          type: array
          items:
            $ref: '#/components/schemas/Index'
        constraints:
          type: array
          items:
            $ref: '#/components/schemas/Constraint'
        foreign_keys:
          type: array
          items:
            $ref: '#/components/schemas/ForeignKey'
    Column:
      type: object
      required:
      - name
      - type
      properties:
        name:
          type: string
          example: id
        type:
          type: string
          example: UUID
        nullable:
          type: boolean
          example: false
        default:
          type: string
          nullable: true
          example: gen_random_uuid()
        description:
          type: string
          example: Primary key - unique user identifier
        primary_key:
          type: boolean
          example: true
    Index:
      type: object
      properties:
        name:
          type: string
          example: idx_profiles_username
        columns:
          type: array
          items:
            type: string
          example:
          - username
        unique:
          type: boolean
          example: true
        type:
          type: string
          example: btree
    Constraint:
      type: object
      properties:
        name:
          type: string
          example: pk_profiles
        type:
          type: string
          enum:
          - PRIMARY KEY
          - UNIQUE
          - CHECK
          - NOT NULL
          example: PRIMARY KEY
        columns:
          type: array
          items:
            type: string
          example:
          - id
    ForeignKey:
      type: object
      properties:
        name:
          type: string
          example: fk_chats_created_by
        from_table:
          type: string
          example: chats
        from_column:
          type: string
          example: created_by
        to_table:
          type: string
          example: profiles
        to_column:
          type: string
          example: id
    Query:
      type: object
      required:
      - number
      - title
      - sql
      properties:
        number:
          type: integer
          example: 1
        title:
          type: string
          example: Production-Grade User Activity Analysis
        description:
          type: string
          example: Enterprise-level user activity analysis
        complexity:
          type: string
          example: Deep nested CTEs (5+ levels)
        sql:
          type: string
          example: WITH user_registration_cohorts AS (...)
        expected_output:
          type: string
          example: Top 20 users ranked by message activity
        categories:
          type: array
          items:
            type: string
          example:
          - User Activity Analysis
          - Cohort Analytics
        database_compatibility:
          type: object
          properties:
            postgresql:
              type: boolean
              example: true
        businessUseCase:
          type: string
          example: Custom Weather Impact Modeling
        clientDeliverable:
          type: string
          example: Forecast accuracy report
        businessValue:
          type: string
          example: Quantifies forecast reliability
        spatial_operations:
          type: array
          items:
            type: string
          example:
          - ST_WITHIN
          - ST_DISTANCE
    SpatialColumn:
      type: object
      properties:
        name:
          type: string
          example: grid_cell_geom
        type:
          type: string
          enum:
          - GEOGRAPHY
          - GEOMETRY
          example: GEOGRAPHY
        geometry_type:
          type: string
          enum:
          - POINT
          - POLYGON
          - LINESTRING
          - MULTIPOINT
          - MULTIPOLYGON
          - MULTILINESTRING
          example: POINT
        crs:
          type: string
          example: EPSG:4326
        description:
          type: string
          example: Point geometry for grid cell center
    SpatialOperation:
      type: object
      properties:
        name:
          type: string
          example: ST_WITHIN
        description:
          type: string
          example: Checks if one geometry is within another
        syntax:
          type: string
          example: ST_WITHIN(geometry1, geometry2)
        return_type:
          type: string
          example: BOOLEAN
        supported_platforms:
          type: array
          items:
            type: string
          example:
          - PostgreSQL (PostGIS)
  examples:
    ProfilesTable:
      summary: Example profiles table
      value:
        name: profiles
        description: Stores user profile information
        columns:
        - name: id
          type: UUID
          nullable: false
          primary_key: true
          description: Primary key - unique user identifier
        - name: username
          type: VARCHAR(255)
          nullable: false
          description: Unique username for login
        indexes:
        - name: idx_profiles_username
          columns:
          - username
          unique: true
    QueryExample:
      summary: Example query
      value:
        number: 1
        title: Production-Grade User Activity Analysis
        description: Enterprise-level user activity analysis
        sql: WITH user_registration_cohorts AS (...) SELECT ...
        expected_output: Top 20 users ranked by message activity
